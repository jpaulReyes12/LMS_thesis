angular.module("lmsApp",["ngRoute","ngAnimate","angularCSS","oc.lazyLoad","firebase","ui.bootstrap"]),angular.module("lmsApp").config(["$routeProvider","$locationProvider",function(e,t){e.when("/",{title:"STC Learning Management System",templateUrl:"view/home.html",css:"style/home.css",controller:"loginCtrl",requireAuth:!1}).when("/home",{title:"STC Learning Management System",templateUrl:"view/home.html",css:"style/home.css",controller:"loginCtrl",requireAuth:!1}).when("/profile_info/:user",{title:"STC Learning Management System",templateUrl:"view/profileInfo.html",css:"style/signup.css",controller:"profileInfoCtrl",requireAuth:!1}).when("/profile",{title:"Profile",templateUrl:"view/studentProfile.html",css:"style/profile.css",requireAuth:!0,resolve:{currentAuth:["$firebaseAuth",function(e){return e().$requireSignIn()}],currentUser:[function(){return firebase.auth().currentUser}]}}).when("/about",{title:"About Us",templateUrl:"view/about.html",css:[{href:"style/home.css",preload:!0},{href:"style/aboutus.css",preload:!0}],requireAuth:!1}).when("/signup",{title:"Sign Up",templateUrl:"view/signup.html",css:"style/signup.css",controller:"signupCtrl",requireAuth:!1}).when("/class_dashboard/class_recordList",{title:"Manage your class",templateUrl:"view/classDash/classRecord.html",css:["style/classDash/component.css","style/classDash/default.css","style/classDash/classdash.css"],requireAuth:!1,resolve:{lazy:["$ocLazyLoad",function(e){return e.load({files:["lib/classie.js","lib/modernizr.custom.js"]})}]}}).when("/class_dashboard/class_recordThumb",{title:"Manage your class",templateUrl:"view/classDash/classRecord2.html",css:["style/classDash/component.css","style/classDash/default.css","style/classDash/classdash.css"],requireAuth:!1,resolve:{lazy:["$ocLazyLoad",function(e){return e.load({files:["lib/classie.js","lib/modernizr.custom.js"]})}]}}).when("/class_dashboard/resources",{title:"Manage your class",templateUrl:"view/classDash/classResources.html",css:["style/classDash/component.css","style/classDash/default.css","style/classDash/classdash.css"],resolve:{lazy:["$ocLazyLoad",function(e){return e.load({files:["lib/modernizr.custom.js","lib/classie.js"]})}]}}).when("/class_dashboard/createannouncement",{title:"Manage your class",templateUrl:"view/classDash/announcementtab.html",css:["style/classDash/component.css","style/classDash/default.css","style/classDash/classdash.css"],resolve:{lazy:["$ocLazyLoad",function(e){return e.load({files:["lib/modernizr.custom.js","lib/classie.js"]})}]}}).when("/class_dashboard/createassignment",{title:"View your resources",templateUrl:"view/classDash/assignmenttab.html",css:["style/classDash/component.css","style/classDash/default.css","style/classDash/classdash.css"],resolve:{lazy:["$ocLazyLoad",function(e){return e.load({files:["lib/modernizr.custom.js","lib/classie.js"]})}]}}).when("/class_dashboard/createquiz",{title:"Manage your class",templateUrl:"view/classDash/quiztab.html",css:["style/classDash/component.css","style/classDash/default.css","style/classDash/classdash.css"],controller:"createQuizCtrl",requireAuth:!0,resolve:{lazy:["$ocLazyLoad",function(e){return e.load({files:["lib/modernizr.custom.js","lib/classie.js"]})}]}}).when("/group",{title:"Your Groups",templateUrl:"view/group.html",css:[{href:"style/group.css",preload:!0},{href:"style/profile.css",preload:!0}],requireAuth:!0,resolve:{currentAuth:["$firebaseAuth",function(e){return e().$requireSignIn()}]}}).when("/forum_home",{title:"Latest Forum Topics",templateUrl:"view/forum_home.html",css:[{href:"style/forum/forum_home.css",preload:!0},{href:"style/profile.css",preload:!0}],requireAuth:!0,resolve:{currentAuth:["$firebaseAuth",function(e){return e().$requireSignIn()}]}}).when("/forum_post",{title:"Forum",templateUrl:"view/forum_post.html",css:[{href:"style/forum/forum_post.css",preload:!0},{href:"style/profile.css",preload:!0}],requireAuth:!0,resolve:{currentAuth:["$firebaseAuth",function(e){return e().$requireSignIn()}]}}).when("/admin",{title:"Admin Page",templateUrl:"view/admin/home.html",css:"style/admin.css",controller:"adminUsersCtrl",requireAuth:!0,resolve:{currentAuth:["$firebaseAuth",function(e){return e().$requireSignIn()}]}}).when("/admin/schedule",{title:"Admin Page",templateUrl:"view/admin/schedule.html",css:"style/admin.css",controller:"adminScheduleCtrl",requireAuth:!0,resolve:{currentAuth:["$firebaseAuth",function(e){return e().$requireSignIn()}]}}).when("/admin/groups",{title:"Admin Page",templateUrl:"view/admin/groups.html",css:"style/admin.css",requireAuth:!0,resolve:{currentAuth:["$firebaseAuth",function(e){return e().$requireSignIn()}]}}).when("/admin/events",{title:"Admin Page",templateUrl:"view/admin/events.html",css:{href:"style/admin.css",preload:!0},controller:"eventsCtrl",requireAuth:!0,resolve:{currentAuth:["$firebaseAuth",function(e){return e().$requireSignIn()}]}}).when("/admin/forum",{title:"Admin Page",templateUrl:"view/admin/forum.html",css:"style/admin.css",requireAuth:!0,resolve:{currentAuth:["$firebaseAuth",function(e){return e().$requireSignIn()}]}}).when("/admin/forum_topics",{title:"Admin Page",templateUrl:"view/admin/forum_topics.html",css:"style/admin.css",requireAuth:!0,resolve:{currentAuth:["$firebaseAuth",function(e){return e().$requireSignIn()}]}}).otherwise({redirectTo:"/"})}]),angular.module("lmsApp").run(["$rootScope",function(e){e.$on("$routeChangeSuccess",function(t,s,r){s.hasOwnProperty("$$route")&&(e.title=s.$$route.title)})}]),angular.module("lmsApp").directive("dirAdminNav",["$location",function(e){var t=function(t){t.logOutUser=function(){firebase.auth().signOut(),e.path("/")},t.location=function(t){return t.substr(1)===e.url()},t.name=""};return{restrict:"E",templateUrl:"components/partials/adminNav.html",link:t}}]),angular.module("lmsApp").directive("dirNav",["$location",function(e){var t=function(t){t.logOutUser=function(){firebase.auth().signOut(),e.path("/")},t.name="",t.NotifNum=3,t.MessageNum=2};return{restrict:"A",templateUrl:"components/partials/navbar.html",link:t}}]),angular.module("lmsApp").controller("createQuizCtrl",["$scope","Questions",function(e,t){var s=firebase.database().ref("/quiz");e.setQuiz=function(e){s.push({q_num:e.qnum,q_title:e.qtitle,q_type:e.qtype}),console.log("pushing")},e.QuestionData=[],e.addQuiz=function(t){e.QuestionData.push({q_question:t.quest,q_answer:t.answer,q_dummy1:t.dummy1,q_dummy2:t.dummy2,q_dummy3:t.dummy3}),console.log("add quiz")},e.saveQuiz=function(){t.addQuiz(e.QuestionData),console.log("save")}}]),angular.module("lmsApp").controller("loginCtrl",["$scope","$firebaseAuth","$firebaseArray","$location",function(e,t,s,r){e.authObj=t();var a=firebase.database().ref("/users");s(a);e.LoginFacebook=function(){e.authObj.$signInWithPopup("facebook").then(function(e){l(e.user.uid)})},e.LoginGoogle=function(){e.authObj.$signInWithPopup("google").then(function(e){l(e.user.uid)})},e.LoginEmail=function(t){e.authObj.$signInWithEmailAndPassword(t.email,t.password).then(function(e){l(e.user.uid)})["catch"](function(e){console.log(e)})};var l=function(e){a.child(e).on("value",function(t){var s=firebase.auth().currentUser;null!==t.val()?a.child(e).on("value",function(e){var t=e.val().utype;switch(t){case"student":r.path("/profile");break;case"teacher":r.path("/profile");break;case"admin":r.path("/admin");break;default:r.path("/profile_info/"+s.uid)}}):r.path("/profile_info/"+s.uid)})}}]),angular.module("lmsApp").controller("profileInfoCtrl",["$scope","$firebaseObject","$location","$routeParams","$firebaseAuth",function(e,t,s,r,a){e.profileInfo={utype:"student"};var l=a(),n=l.$getAuth(),o=r.user,i=firebase.database().ref("/users/"+o),u=t(i),c=new Date(Date.now()).toLocaleString();e.submitInfo=function(e){u.utype=e.utype,u.firstname=e.firstname,u.lastname=e.lastname,u.description=e.Description,u.email=n.email,u.dateCreated=c,u.dateSignedIn=c,u.isActive=!0,u.$save().then(function(e){i.update({uid:e.key}),n?s.path("/profile"):s.path("/")})["catch"](function(e){console.log(e)})}}]),angular.module("lmsApp").controller("signupCtrl",["$scope","$firebaseArray","$firebaseAuth","$location",function(e,t,s,r){e.load=!1;var a=s(),l=firebase.database().ref("/users");t(l);e.LoginFacebook=function(){e.load=!0,a.$signInWithPopup("facebook").then(function(e){r.path("/profile_info/"+e.user.uid)})["catch"](function(t){e.load=!1,alert("Authentication failed: ",t.message)})},e.LoginGoogle=function(){e.load=!0,a.$signInWithPopup("google").then(function(e){r.path("/profile_info/"+e.user.uid)})["catch"](function(t){e.load=!1,alert("Authentication failed: ",t.message)})},e.submitForm=function(t){e.reg_form.$valid&&a.$createUserWithEmailAndPassword(t.email,t.password).then(function(e){r.path("/profile_info/"+e.uid)})["catch"](function(t){e.load=!1,"auth/email-already-in-use"===t.code?alert(t.message):console.log("Auth failed: "+t)})}}]),angular.module("lmsApp").service("pageAuth",["$location","$rootScope",function(e,t){var s=function(t,s,r,a){console.log(s),"AUTH_REQUIRED"===a&&e.path("/")};t.$on("$routeChangeError",s)}]),angular.module("lmsApp").run(function(e){}),angular.module("lmsApp").factory("Questions",["$firebaseArray",function(e){function t(e){r.$add(e)}var s=firebase.database().ref("/quiz/questions"),r=e(s);return{addQuiz:t}}]),angular.module("lmsApp").factory("Schedule",["$firebaseArray",function(e){function t(){return a}function s(e){a.$add(e)}var r=firebase.database().ref("/schedule"),a=e(r);return{getSched:t,addSched:s}}]),angular.module("lmsApp").factory("Users",["$firebaseArray",function(e){function t(){return r}var s=firebase.database().ref("/users"),r=e(s);return{getUsers:t}}]),angular.module("lmsApp").controller("adminScheduleCtrl",["$scope","Schedule","Users","uibButtonConfig",function(e,t,s,r){e.theSchedule=t.getSched(),e.theTeachers=s.getUsers(),e.toggleAdd=!0,r.activeClass="btn-primary",e.searchSchedule="",e.sortType="section",e.sortReverse="false",e.checkAll=function(){e.selectedAll?e.selectedAll=!0:e.selectedAll=!1,angular.forEach(e.theSchedule,function(t){t.Selected=e.selectedAll})},e.Days={mon:!1,tue:!0,wed:!1,thu:!1,fri:!1},e.sched={Section:null},e.insertSched=function(e){var s=(new Date).getFullYear(),r=s+1;e.timeStart=e.timeStart.getTime(),e.timeEnd=e.timeEnd.getTime(),e.isActive=!0,e.SY=String(s)+" - "+String(r),console.log(e.SY),t.addSched(e)}}]),angular.module("lmsApp").controller("adminUsersCtrl",["$scope","Users",function(e,t){e.theUsers=t.getUsers(),e.searchUsers="",e.sortType="Email",e.sortReverse="false",e.checkAll=function(){e.selectedAll?e.selectedAll=!0:e.selectedAll=!1,angular.forEach(e.theUsers,function(t){t.Selected=e.selectedAll})}}]),angular.module("lmsApp").controller("eventsCtrl",["$scope",function(e){e.toggleAdd=!0;var t=new Date;e.dateNow=t;var s=new Date,r=s.setFullYear(s.getFullYear()+20);e.futureDate=r}]);